###This file includes codes for performance evaluation###

###Calculate ARI and V-measure in python###
from sklearn import metrics

def ARI(pre_label1, pre_label2):
    return(metrics.adjusted_rand_score(pre_label1, pre_label2))

def V_measure(pre_label1, pre_label2):
    return(metrics.v_measure_score(pre_label1, pre_label2))

###Using UMAP and hierarchical clustering for visualization###
library(umap)
library(pheatmap)


UMAP_plot <- function(CA,cell_label,"data_name"){
     em_bd <- umap(1-CA,input='dist',n_components=2)$layout
     df_plot <- data.frame(cell_label,em_bd[,1],em_bd[,2])
     colnames(df_plot) <- c("data_name","Dimension1","Dimension2")
     df_plot$GSE87197 <- factor(df_plot$data_name)
     plot_umap <- ggplot(df_plot, aes(x = Dimension1, y = Dimension2,color=data_name,shape=data_name)) +
                                        geom_point(size=3)+
            		        scale_color_brewer(palette = "Set2")+
            		        scale_shape_manual(values = c(0,1,2,5,6,7))
            		        theme_set(theme_bw())
    return(plot_umap)
   }

hc_heatmap <- function(CA){
   return(pheatmap(as.matrix(CA),cutree_rows = NA,cutree_cols=NA,
                    cellwidth = 8, cellheight = 8))
}
